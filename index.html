<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Letsee AR Demo - Ultima Cena</title>
	<meta content="minimum-scale=1.0, width=device-width, maximum-scale=1, user-scalable=no, viewport-fit=cover" name="viewport" />
	<script src="./Letsee.0.9.14.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Noto+Sans:100,300,400,700,900&display=swap" rel="stylesheet">
	<script src="//code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
	<script src="//code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU=" crossorigin="anonymous"></script>
	<script src="./vendor/jquery.scrollbar.min.js"></script>
	<link rel="stylesheet" href="./vendor/jquery.scrollbar.css">

	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/comments.css">
	<link rel="stylesheet" href="css/response.css">

	<style media="place" type="text/css">
		#container {
			-letsee-target: uri('ultima-cena.json');
			-letsee-position: coords(0, 0, 0);
			/*border: 1px solid #f00;*/
			width: 1000px;
			height: 560px;
			border: 1px solid red;
		}
	</style>
</head>
<body>

<!--Detect the phone orientation-->
<div id="detect">
	<img id="detect_img" src="assets/rotate_detect.png" alt=""/>
	<img id="detect_msg" src="assets/detect_msg.png" alt="">
</div>

<!--Show at first time to alert user-->
<div id="capture" style="display: block">
	<img id="cap1" src="assets/camera.png" alt="">
	<p>작품을 정면으로 촬영해주세요.</p>
</div>

<div id="container" style="">
</div>

<script type="text/javascript">

	/**
	 * Letsee Initialize function.
	 */
	function InitLetsee() {
		let CURRENT_URI = null;
		let currentTarget = null;
		const world = new Object3D();

		const initWorld = (e) =>  {
			let uri = e.target.uri;

			if (CURRENT_URI == null) {
				CURRENT_URI = uri;
				currentTarget = app.engine.getEntity(CURRENT_URI);
				e.target.addRenderable(world);
			}

			if (uri !== CURRENT_URI) {
				app.engine.getEntity(CURRENT_URI).removeRenderable(world);
				CURRENT_URI = uri;
				currentTarget = app.engine.getEntity(CURRENT_URI);
				e.target.addRenderable(world);
			}
		};

		const config = {
			"appKey": "8hTenCFZL3q3jIBZLHoQ72QYTvJdKM5IROK5hdUS69JeH91iGfWD7ApQWZSwzN2g",
			"trackerType": "PLANAR",
			"isSteady": true
		};
		const app = new Letsee(config);
		if(app !== null && typeof app !== 'undefined') {
			app.addEventListener('trackstart', e => {
				initWorld(e);
				switchPage(1);
			});

			app.addEventListener('trackend', e => {
				initWorld(e);
				switchPage(0)
			})
		}
	}

	/**
	 * When the document is loaded, letsee is initialized.
	 */
	$(document).ready(() => {
		InitLetsee();
	});

	/**
	 * Change page function
	 * 0: Initial Page (Before Detecting)
	 * 1: Main Page
	 */

	function switchPage(num) {
		switch (num) {
			// Initial Page
			case 0: {
				document.getElementById('capture').style.display = 'block';
				break;
			}

			// Main Page
			case 1: {
				document.getElementById('capture').style.display = 'none';
				break;
			}
		}
	}



</script>
<!--<script type="text/javascript" src="js/hammer.js"></script>-->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/screenfull.js/4.2.0/screenfull.min.js"></script>-->
<!--<script>let fs=!1;document.documentElement.addEventListener("click",()=>{screenfull.enabled&&!fs&&(screenfull.request(),fs=!0)});</script>-->
</body>
</html>
